import MainLayout from '~/components/layouts/main'
import Figure from '~/components/Figure'

export const meta = {
  title: 'Введение'
}

export default ({ children }) => <MainLayout meta={meta}>{children}</MainLayout>

# Введение

Программные системы состоят из модулей, которые мы можем условно поделить на низкоуровневые и высокоуровневые.

_Низкоуровневые_ содержат утилитарную функциональность. _Высокоуровневые_ содержат сложную, более абстрактную бизнес-логику.

В устойчивых системах высокоуровневые модули, как правило, переиспользуемы и не требуют обновления при изменении низкоуровневых. Добиться подобной устойчивости помогает принцип инверсии зависимостей.

## Принцип инверсии зависимостей

[Принцип инверсии зависимостей](https://ru.wikipedia.org/wiki/Принцип_инверсии_зависимостей) (Dependency Inversion Principle, DIP) предполагает, что:
- Высокороувневые модули не должны зависеть от низкоуровневых; оба типа должны зависеть от абстракций.
- Абстракции не должны зависеть от деталей, детали должны зависеть от абстракций.

Таким образом DIP помогает снизить [сцепление модулей](https://ru.wikipedia.org/wiki/Зацепление_(программирование)) (coupling).

Когда модули жёстко сцеплены, они слишком много знают друг о друге и не функционируют по отдельности. В такой ситуации изменения в одном будут требовать изменений в других — что нарушает [OCP](/ocp).

## Сцепление и связность

_Сцепление_ (coupling) не стоит путать со _связностью_ (cohesion).

[Сцепление](https://ru.wikipedia.org/wiki/Зацепление_(программирование)) — степень взаимозависимости разных модулей. Чем выше связанность, тем более хрупкой получается система, и тем сложнее вносить изменения.

[Связность](https://ru.wikipedia.org/wiki/Связность_(программирование)) — степень, в которой задачи некоторого модуля, связаны друг с другом. Чем ниже связность, тем строже модули следуют [SRP](/srp), тем выше сфокусирован модуль на конкретной задаче.

## Абстракции

Согласно принципу модули не должны зависеть не от других модулей напрямую, а от абстракций.

В [примере c регулятором температуры](http://stg-tud.github.io/sedc/Lecture/ws13-14/3.5-DIP.html#mode=document) на схеме ниже структура системы нарушает DIP. Модули зависят напрямую от других модулей, это увеличивает сцепление.

<Figure>
  <img src='/static/dip-violation.svg' />
  <figcaption>Модули зависят от конкретных модулей, это увеличивает сцепление</figcaption>
</Figure>

Исправленный вариант вводит прослойку между сущностями в виде абстракций — интерфейсов.

Модулям теперь не обязательно работать с конкретными модулями, они могут работать с любой сущностью, которая реализует указанный интерфейс. Так снижается сцепление.

<Figure>
  <img src='/static/dip-compliance.svg' />
  <figcaption>Абстракции в виде интерфейсов позволяют снизить сцепление</figcaption>
</Figure>

## DIP и тестируемость

При тестировании модуля, который зависит от других модулей, нам нужно либо инстанциировать экземпляр каждой зависимости, либо создать заглушки.

 DIP упрощает тестирование системы. Если модули зависят от интерфейсов, нам достаточно создать заглушку, реализующую этот интерфейс.

## Материалы к разделу
- [Принцип инверсии зависимостей, Википедия](https://ru.wikipedia.org/wiki/Принцип_инверсии_зависимостей)
- [Принцип инверсии зависимостей, Александр Бындю](https://blog.byndyu.ru/2009/12/blog-post.html)
- [Принцип инверсии зависимостей, MakeDev](https://makedev.org/principles/solid/dip.html)
- [Сцепление модулей](https://ru.wikipedia.org/wiki/Зацепление_(программирование))
- [Связность модулей](https://ru.wikipedia.org/wiki/Связность_(программирование))
- [GRASP](https://ru.wikipedia.org/wiki/GRASP)
- [Inversion of Control Containers and the Dependency Injection pattern](https://martinfowler.com/articles/injection.html)
- [Пример с терморегулятором](http://stg-tud.github.io/sedc/Lecture/ws13-14/3.5-DIP.html#mode=document)

## Вопросы
**Согласно DIP отношение между модулями должно быть следующим:**

Высокороувневые модули должны зависеть от низкоуровневых (Согласно DIP высокороувневые модули не должны зависеть от низкоуровневых, и оба типа должны зависеть от абстракций.)

Низкоуровневые модули должны зависеть от высокоуровневых (Согласно DIP высокороувневые модули не должны зависеть от низкоуровневых, и оба типа должны зависеть от абстракций.)

_Высокороувневые модули должны зависеть от абстракций_

_Низкоуровневые модули должны зависеть от абстракций_

**Для устойчивой системы характерны:**

_Низкое сцепление, высокая связность_

Низкое сцепление, низкая связность (Сцепление — степень взаимозависимости разных модулей. Чем она выше, тем более хрупкой получается система. Связность — степень, в которой задачи некоторого модуля, связаны друг с другом. Чем ниже связность, тем выше сфокусирован модуль на конкретной задаче.)

Высокое сцепление, низкая связность (Сцепление — степень взаимозависимости разных модулей. Чем она выше, тем более хрупкой получается система. Связность — степень, в которой задачи некоторого модуля, связаны друг с другом. Чем ниже связность, тем выше сфокусирован модуль на конкретной задаче.)

Высокое сцепление, высокая связность (Сцепление — степень взаимозависимости разных модулей. Чем она выше, тем более хрупкой получается система. Связность — степень, в которой задачи некоторого модуля, связаны друг с другом. Чем ниже связность, тем выше сфокусирован модуль на конкретной задаче.)

**В чём заключается польза DIP?**

_Снижается сцепление модулей_

Повышается сцепление модулей (DIP позволяет снизить сцепление и повысить связность.)

Снижается связность модулей (DIP позволяет снизить сцепление и повысить связность.)

_Повышается связность модулей_

*[GRASP]:General Responsibility Assignment Software Patterns
*[DIP]:Dependency Inversion Principle
*[OCP]:Open-Closed Principle
*[SRP]:Single Responsibility Principle
